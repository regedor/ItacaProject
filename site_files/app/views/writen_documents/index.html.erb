<% content_for :page_title do %>Lista de Documentos Escritos<% end %>


<div id=writen_documents-index-list class=resource-list>

  <p><%=h "
    A Base de Dados Imagens e Sonoridades das Migrações conta, neste momento, com #{WritenDocument.count} documentos escritos." %>
  </p>

  <div id="search_filters">
  <% form_tag writen_documents_path, :method => 'get' do %>
    <div class="search_field">
      <%= label :author_id, 'Author' %>
      <%= select_tag 'author_id', options_for_select(
            [["-- Todos --",'']] + Author.find(:all, :order => 'name').map { |o| [o.name, o.id] },
            params[:author_id].to_i) %>
    </div>
    <div class="search_field">
      <%= label :category_id, 'Categoria' %>
      <%= select_tag 'category_id', options_for_select(
            [["-- Todas --",'']] + Category.find(:all, :order => 'name').map { |o| [o.name, o.id] },
            params[:category_id].to_i) %>
    </div>
    <div class="search_field">
      <%= label :document_type_id, 'Tipo' %>
      <%= select_tag 'document_type_id', options_for_select(
            [["-- Todos --",'']] + DocumentType.find(:all, :order => 'name').map    { |o| [o.name, o.id] },
            params[:document_type_id].to_i) %>
    </div>
    <div class="search_field">
      <%= label :keywords, 'Palavras&nbsp;chave' %>
      <%= text_field_tag 'keywords', params[:keywords], :size => 32 %>
    </div>
    <%= submit_tag 'Pesquisar', :name => nil %>                        
  <% end %> 

  <p>
    <% unless params[:author_id] || params[:director_id] || params[:music_genre_id] || params[:keywords] %>
      A listagem de documentos escritos pode ser limitada através de uma pesquisa.
      Introduza os parametros e carregue em pesquisar.
    <% else %>
    <% if @writen_documents.size == 0 %>
      Não foram encontrados documentos escritos.
    <% elsif @writen_documents.size == 1 %>
      Foi encontrado 1 documento escrito.
    <% else %>
      Foram encontrados <%= @writen_documents.size %> documentos escritos.
    <% end %> 
    Para desfazer a pesquisa click <%= link_to 'aqui', writen_documents_path %>.
    <% end %>
  </p>
  </div>




  <table>

    <tr class="table-header">
      <th class="main"> <%=h "Title".humanize %>          </th>
      <th>              <%=h "Author".humanize %>       </th>
      <th>              <%=h "Tipo".humanize %>         </th>
    </tr>
  
    <% for writen_document in @writen_documents %>
    <tr <%= cycle "", "class='odd'"%> href="<%= writen_document_path(writen_document)%>">
      <td class="main">
        <%= link_to h(truncate(writen_document.title,46,"...")), writen_document_path(writen_document), :title => writen_document.synopsis %>            
      </td>
      <td class="director">
        <%= link_to h(truncate(authors_names(writen_document),43,"...") || ""), writen_document_path(writen_document), :title => writen_document.synopsis %> 
      </td>
      <td class="genre">
        <%= link_to h(writen_document.document_type && truncate(writen_document.document_type.name,15,"...") || ""), writen_document_path(writen_document), :title => writen_document.synopsis %> 
      </td>
    </tr>
    <% end %>

  </table>
</div>


